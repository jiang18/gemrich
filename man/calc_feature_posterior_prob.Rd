% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_feature_posterior_prob.R
\name{calc_feature_posterior_prob}
\alias{calc_feature_posterior_prob}
\title{Calculate Genomic-Feature Posterior Probabilities from Fine-Mapping}
\usage{
calc_feature_posterior_prob(
  model,
  feature,
  extension = 3000,
  pvalue_threshold = 5e-05,
  input_type = "forward_selection",
  pip = NULL
)
}
\arguments{
\item{model}{A \code{data.frame} or \code{data.table} containing fine-mapping summary statistics generated by BFMAP.
For forward selection: Required columns are signal, SNPindex, Chr, Pos, Pval, and normedProb.
For SSS: Required columns are variant IDs (first n-2 columns) and probabilities (the last column).}

\item{feature}{A \code{data.frame} or \code{data.table} containing genomic feature coordinates and identifiers.
Required columns are chr, start, end, and feature_id.}

\item{extension}{A numeric value specifying the number of base pairs to extend upstream and downstream of each feature (default: 3000).}

\item{pvalue_threshold}{A numeric threshold for filtering fine-mapped signals based on p-values (default: 5e-5).
Only used for forward selection format.}

\item{input_type}{Character string specifying the input format: "forward_selection" (default) or "sss".}

\item{pip}{For SSS format: A \code{data.table} with variant-level PIP data.
Required columns are SNPname, Chr, and Pos.}
}
\value{
A \code{data.table} containing features and their posterior probabilities of containing causal variants.
}
\description{
This function calculates the posterior probability of genomic features containing causal variants
by integrating fine-mapping results with genomic feature annotations. For forward selection, it uses
SNP-level probabilities. For SSS, it uses model-level probabilities.
}
\examples{
data("dairy_example")
# Forward selection
feature_probs = calc_feature_posterior_prob(
  dairy_example$bfmap, 
  dairy_example$gene_annot, 
  extension = 1000, 
  pvalue_threshold = 5e-7
)
# SSS
# feature_probs_sss = calc_feature_posterior_prob(
#   sss_model_data,
#   gene_annot, 
#   extension = 3000,
#   input_type = "sss",
#   pip = sss_pip_data
# )

}
