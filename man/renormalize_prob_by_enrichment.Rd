% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/renormalize_prob_by_enrichment.R
\name{renormalize_prob_by_enrichment}
\alias{renormalize_prob_by_enrichment}
\title{Renormalize Fine-Mapping Probabilities Using Functional Enrichment Estimates}
\usage{
renormalize_prob_by_enrichment(
  bfmap,
  snpinfo,
  enrichment_mle,
  annot = "multi_cat"
)
}
\arguments{
\item{bfmap}{A \code{data.frame} containing fine-mapping summary data generated by BFMAP (forward selection).
Required columns are signal, normedProb, and SNPname.}

\item{snpinfo}{A \code{data.frame} or \code{data.table} containing SNP functional annotation data, which can be generated using \code{map_snp_annotation()}.}

\item{enrichment_mle}{A \code{data.frame} of enrichment estimates from estimate_category_enrichment(),
containing fold enrichments of genetic effects across functional annotation categories.}

\item{annot}{A character string specifying a functional annotation column in snpinfo (default: "multi_cat").}
}
\value{
A \code{data.table} with renormalized probabilities (renormedProb). Other columns from the input bfmap are preserved.
}
\description{
This function takes SNP probabilities from fine-mapping and renormalizes them within each
signal using functional enrichment estimates. For each signal, SNP probabilities are
multiplied by enrichment factors and renormalized to their original sum.
}
\examples{
data("dairy_example")
mle_result <- estimate_category_enrichment(
  dairy_example$bfmap,
  dairy_example$snp2annot,
  dairy_example$cat_prop
)
renormed_bfmap <- renormalize_prob_by_enrichment(
  dairy_example$bfmap,
  dairy_example$snp2annot,
  mle_result$enrichment_mle
)

}
