% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bootstrap_category_enrichment.R
\name{bootstrap_category_enrichment}
\alias{bootstrap_category_enrichment}
\title{Compute Empirical Distributions of Enrichments with Bootstrapping}
\usage{
bootstrap_category_enrichment(
  bfmap,
  snpinfo,
  cat_prop,
  annot = "multi_cat",
  pvalue_threshold = 5e-05,
  n_bootstraps = 1000,
  seed = 1
)
}
\arguments{
\item{bfmap}{A \code{data.frame} or \code{data.table} containing fine-mapping summary statistics generated by BFMAP (forward selection).
Required columns are signal, SNPindex, Pval, normedProb, and SNPname.}

\item{snpinfo}{A \code{data.frame} or \code{data.table} containing SNP functional annotation data, which can be generated using \code{map_snp_annotation()}.}

\item{cat_prop}{A \code{data.frame} or \code{data.table} containing the proportion of SNPs in each annotation category.
This can be generated using either \code{calc_snp_category_prop()} or \code{calc_category_coverage()}.}

\item{annot}{A character string specifying the functional annotation column to analyze (default: "multi_cat").
The specified name must match a column name in the snpinfo input.}

\item{pvalue_threshold}{A numeric threshold for filtering fine-mapped signals based on p-values (default: 5e-5).
Signals with lead SNP p-values below this threshold are included in the analysis.}

\item{n_bootstraps}{A numeric value specifying the number of bootstrap replicates (default: 1000).}

\item{seed}{A numeric value specifying the random seed for resampling signals (default: 1).}
}
\value{
A list containing:
\item{prob_mle}{Bootstrap distributions of probabilities of causal variants being in annotation categories}
\item{enrichment_mle}{Bootstrap distributions of genetic effect enrichments in annotation categories}
\item{loglik}{Bootstrap distribution of log-likelihood value at the maximum}
}
\description{
This function performs bootstrapping to construct empirical distributions of genetic effect enrichments in functional annotation categories.
}
\examples{
data("dairy_example")
# Use 5 bootstraps for quick testing
bootstrap_result <- bootstrap_category_enrichment(
  dairy_example$bfmap,
  dairy_example$snp2annot,
  dairy_example$cat_prop,
  pvalue_threshold = 5e-5,
  n_bootstraps = 5
)

}
