% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/calc_gene_posterior_prob.R
\name{calc_gene_posterior_prob}
\alias{calc_gene_posterior_prob}
\title{Calculate Gene-level Posterior Probabilities from Fine-Mapping}
\usage{
calc_gene_posterior_prob(
  bfmap,
  gene_annot,
  extension = 0,
  pvalue_threshold = 5e-05
)
}
\arguments{
\item{bfmap}{A \code{data.frame} or \code{data.table} containing fine-mapping summary statistics generated by BFMAP (forward selection).
Required columns are signal, SNPindex, Chr, Pos, Pval, and normedProb.}

\item{gene_annot}{A \code{data.frame} or \code{data.table} containing gene coordinates and identifiers.
Required columns are chr, start, end, and gene_id.}

\item{extension}{A numeric value specifying the number of base pairs to extend upstream and downstream of each gene (default: 0).}

\item{pvalue_threshold}{A numeric threshold for filtering fine-mapped signals based on p-values (default: 5e-5).
Signals with lead SNP p-values below this threshold are included in the analysis.}
}
\value{
A \code{data.table} containing genes and their posterior probabilities of containing causal variants.
}
\description{
This function calculates the posterior probability of genes containing causal variants
by integrating BFMAP forward-selection fine-mapping results with gene annotations.
The probability for each gene is computed by summing the normalized probabilities of SNPs within its region.
}
\examples{
data("dairy_example")
gene_probs = calc_gene_posterior_prob(
  dairy_example$bfmap, 
  dairy_example$gene_annot, 
  extension = 1000, 
  pvalue_threshold = 5e-7
)

}
